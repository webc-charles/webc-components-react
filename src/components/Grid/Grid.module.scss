@use 'sass:map';
@use 'styles/mq' as *;

$gaps: (
  none: 0,
  xs: 0.5rem,
  sm: 1rem,
  md: 1.5rem,
  lg: 2rem,
  xl: 3rem,
);

// Base grid
.grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(1, 1fr);
}

// Grid columns - base
@for $i from 1 through 12 {
  .grid--#{$i} {
    grid-template-columns: repeat(#{$i}, 1fr);
  }
}

// Gap - base
@each $name, $value in $gaps {
  .grid--gap-#{$name} {
    gap: $value;
  }
}

// GridItem column spans - base
.gridItem {
  grid-column: span 1;
}

@for $i from 1 through 12 {
  .gridItem-#{$i} {
    grid-column: span #{$i};
  }
}

// Row spans - base
@for $i from 1 through 6 {
  .gridItem--row-#{$i} {
    grid-row: span #{$i};

    > * {
      height: 100%;
    }
  }
}

// Responsive - XS
@include mq-xs {
  @for $i from 1 through 12 {
    .grid--xs-#{$i} {
      grid-template-columns: repeat(#{$i}, 1fr);
    }
    .gridItem--xs-#{$i} {
      grid-column: span #{$i};
    }
  }

  @each $name, $value in $gaps {
    .grid--gap-xs-#{$name} {
      gap: $value;
    }
  }

  @for $i from 1 through 6 {
    .gridItem--row-xs-#{$i} {
      grid-row: span #{$i};

      > * {
        height: 100%;
      }
    }
  }
}

// Responsive - SM
@include mq-sm {
  @for $i from 1 through 12 {
    .grid--sm-#{$i} {
      grid-template-columns: repeat(#{$i}, 1fr);
    }
    .gridItem--sm-#{$i} {
      grid-column: span #{$i};
    }
  }

  @each $name, $value in $gaps {
    .grid--gap-sm-#{$name} {
      gap: $value;
    }
  }

  @for $i from 1 through 6 {
    .gridItem--row-sm-#{$i} {
      grid-row: span #{$i};

      > * {
        height: 100%;
      }
    }
  }
}

// Responsive - MD
@include mq-md {
  @for $i from 1 through 12 {
    .grid--md-#{$i} {
      grid-template-columns: repeat(#{$i}, 1fr);
    }
    .gridItem--md-#{$i} {
      grid-column: span #{$i};
    }
  }

  @each $name, $value in $gaps {
    .grid--gap-md-#{$name} {
      gap: $value;
    }
  }

  @for $i from 1 through 6 {
    .gridItem--row-md-#{$i} {
      grid-row: span #{$i};

      > * {
        height: 100%;
      }
    }
  }
}

// Responsive - LG
@include mq-lg {
  @for $i from 1 through 12 {
    .grid--lg-#{$i} {
      grid-template-columns: repeat(#{$i}, 1fr);
    }
    .gridItem--lg-#{$i} {
      grid-column: span #{$i};
    }
  }

  @each $name, $value in $gaps {
    .grid--gap-lg-#{$name} {
      gap: $value;
    }
  }

  @for $i from 1 through 6 {
    .gridItem--row-lg-#{$i} {
      grid-row: span #{$i};

      > * {
        height: 100%;
      }
    }
  }
}

// Responsive - XL
@include mq-xl {
  @for $i from 1 through 12 {
    .grid--xl-#{$i} {
      grid-template-columns: repeat(#{$i}, 1fr);
    }
    .gridItem--xl-#{$i} {
      grid-column: span #{$i};
    }
  }

  @each $name, $value in $gaps {
    .grid--gap-xl-#{$name} {
      gap: $value;
    }
  }

  @for $i from 1 through 6 {
    .gridItem--row-xl-#{$i} {
      grid-row: span #{$i};

      > * {
        height: 100%;
      }
    }
  }
}

// Masonry layout using CSS columns
.masonry {
  column-count: 1;
  column-gap: 1rem;
  display: block;

  // Override grid display
  grid-template-columns: unset;
}

// Masonry columns - base
@for $i from 1 through 12 {
  .masonry.grid--#{$i} {
    column-count: #{$i};
  }
}

// Masonry gaps - base
@each $name, $value in $gaps {
  .masonry.grid--gap-#{$name} {
    column-gap: $value;
  }
}

// Masonry item
.masonryItem {
  break-inside: avoid;
  margin-bottom: 1rem;
}

@each $name, $value in $gaps {
  .masonry.grid--gap-#{$name} .masonryItem {
    margin-bottom: $value;
  }
}

// Remove margin from last items (CSS can't do this perfectly with columns)
.masonry.grid--gap-none .masonryItem {
  margin-bottom: 0;
}

// Masonry responsive - XS
@include mq-xs {
  @for $i from 1 through 12 {
    .masonry.grid--xs-#{$i} {
      column-count: #{$i};
    }
  }

  @each $name, $value in $gaps {
    .masonry.grid--gap-xs-#{$name} {
      column-gap: $value;
    }

    .masonry.grid--gap-xs-#{$name} .masonryItem {
      margin-bottom: $value;
    }
  }
}

// Masonry responsive - SM
@include mq-sm {
  @for $i from 1 through 12 {
    .masonry.grid--sm-#{$i} {
      column-count: #{$i};
    }
  }

  @each $name, $value in $gaps {
    .masonry.grid--gap-sm-#{$name} {
      column-gap: $value;
    }

    .masonry.grid--gap-sm-#{$name} .masonryItem {
      margin-bottom: $value;
    }
  }
}

// Masonry responsive - MD
@include mq-md {
  @for $i from 1 through 12 {
    .masonry.grid--md-#{$i} {
      column-count: #{$i};
    }
  }

  @each $name, $value in $gaps {
    .masonry.grid--gap-md-#{$name} {
      column-gap: $value;
    }

    .masonry.grid--gap-md-#{$name} .masonryItem {
      margin-bottom: $value;
    }
  }
}

// Masonry responsive - LG
@include mq-lg {
  @for $i from 1 through 12 {
    .masonry.grid--lg-#{$i} {
      column-count: #{$i};
    }
  }

  @each $name, $value in $gaps {
    .masonry.grid--gap-lg-#{$name} {
      column-gap: $value;
    }

    .masonry.grid--gap-lg-#{$name} .masonryItem {
      margin-bottom: $value;
    }
  }
}

// Masonry responsive - XL
@include mq-xl {
  @for $i from 1 through 12 {
    .masonry.grid--xl-#{$i} {
      column-count: #{$i};
    }
  }

  @each $name, $value in $gaps {
    .masonry.grid--gap-xl-#{$name} {
      column-gap: $value;
    }

    .masonry.grid--gap-xl-#{$name} .masonryItem {
      margin-bottom: $value;
    }
  }
}
